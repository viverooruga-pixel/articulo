<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Buscar art√≠culo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

  <h2>üîç Buscar art√≠culo</h2>

  <form id="form-buscar">
    <input 
      type="text" 
      id="nombre" 
      placeholder="Ej. zapote"
      required
    >
    <button type="submit">Buscar</button>
  </form>

  <hr>

  <div id="resultado"></div>

  <script>
    const form = document.getElementById("form-buscar");

    form.addEventListener("submit", function (e) {
      e.preventDefault(); // üî• ESTO ES LA CLAVE

      const nombre = document.getElementById("nombre").value.trim();
      if (!nombre) return;

      fetch(`https://onie-undeprived-semaj.ngrok-free.dev/articulos/buscar?nombre=${encodeURIComponent(nombre)}`)
        .then(res => {
          if (!res.ok) throw new Error("Error HTTP " + res.status);
          return res.json();
        })
        .then(data => {
          let html = "<ul>";
          data.forEach(a => {
            html += `
              <li>
                <b>${a.descripcion}</b><br>
                Precio: $${a.precio1}<br>
                Existencia: ${a.existencia}<br>
                <a href="./?id=${a.art_id}">Ver detalle</a>
                <hr>
              </li>
            `;
          });
          html += "</ul>";
          document.getElementById("resultado").innerHTML = html;
        })
        .catch(err => {
          document.getElementById("resultado").innerHTML =
            "<p>Error buscando art√≠culos</p>";
          console.error(err);
        });
    });
  </script>

</body>
</html>
